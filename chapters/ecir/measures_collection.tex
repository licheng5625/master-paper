% \todo{
% 	\begin{enumerate}
% 	  \item Historical Query Intent in more detail. Also the query model.
% 	  \item Collection Model
% 	  \item Clear problem statement
% 	  \item 2d model and diversity problem
% 	\end{enumerate}
% }

\section{Historical Query Intent} % (fold)

%\paragraph{	
	%Considering Rudolph Giuliani as the intent, let us assume the result set contains aspects like election campaigns, city politics and terrorist attack. If we use a standard retrieval model without diversification there is a possibility that all results in the top k are only from one aspect and hence may only satisfy one subtopic. The same retrieval model with diversity between aspects may give you coverage of more subtopics but there is still th possibility of covering Rudolph Giuliani's election campaign (of which there are 3) from only one of the years. Consider the scenario where we choose to only diversify across time; we will be able to cover many subtopics if they are events but by doing so we will not be able to cover diverse aspects within a certain time window. Also in an effort to diversify across time we neglect diversity in terms of aspects. Thus to be able to satisify a user's historical intent we need to diversify along both dimensions: time as well as aspects.
%}

%We do not attempt to just cover the most important events from the document collection for a given topic but instead to serve documents to the user which cover as many diverse subtopics of a topic's history. For example, a user is searching for Rudolph Giuliani with the intention of learning about his history. The search system should ideally deliver a set of top k documents that tries to address every subtopic: his mayoral campaigns, his mayorality, race for senate, his personal life and his efforts during 9/11. As is the case with any underspecified query intent, the system is unaware of the possible subtopics that a user might be interested in. Aspects are mined from the document collection or other sources in order to represent possible subtopics of a given intent. An alternate approach to mining subtopics is the usage of query logs from a search engine. 

%We model this intent akin to a multi faceted user intent in a search result diversification problem, where each facet is treated as a separate subtopic. In search result diversification, the user is presented with a list of k diverse results so that diverse user intents can be satisifed in the top k leading to a larger population of satisfied users. However, for a historical query intent the user is presented with a list of k results which represent the diverse historical subtopics of $j$. A historical subtopic refers to any event or topic that is relevant from a historical perspective.  


% For Rudolph Giuliani, we have 7 intents or subtopics in total. Each subtopic is relevant at different periods in time. The time period between 1989 to 1999 is considered very important for Rudolph Giuliani since he was in the news very often during this period. The important aspects during this time period are: his run for senate (1999) and his mayoral campaigns from \'89 \'94 and \'97. We want to serve the user with documents that cover these aspects at their corresponding relevant time periods and we do this using the principle of diversity. Once the user has been served a document from 1999 about Giuliani's senate campaign we dont need to cover that aspect or time period any more in the result set. The next document now can either be from another subtopic but from a different but relevant time window. In this way we want to iteratively construct a result set for the user which covers as many intents as possible with documents from relevant aspects and time windows.

Historical Query Intent is the moniker we choose to describe a user's intent to cover as many historically relevant subtopics and time windows for a given topic. We operate on a document collection $\mathcal{D}$, where each document $d_t$ is associated with a timestamp $t$ corresponding to its publication date. The entire span of the document collection is sub-divided into a set of non-overlapping time windows $\mathcal{T} = \{t_1,t_2,t_3 ... t_n \}$. We require that each document $d_t$ has exactly one publication date $t$ implying that it belongs to exactly one time window denoted by $w(d_t) \in \mathcal{T}$, i.e., $begin(w(d_t)) \leq t \leq end(w(d_t))$ where $begin(w(d_t))$ and $end(w(d_t))$ denote the begin and end time boundaries of $w(d_t)$. Additionally, each $d_t \in \mathcal{D}$ is labeled with a set of aspects which are used to describe the content of $d_t$. We let $\mathcal{A}$ be a universal set of all aspects such that $A_d \subseteq \mathcal{A}$ is the set of aspects for the document $d_t$. 


%Given a set of documents $\mathcal{D}$, the problem is to determine a set of k documents which cover the most important subtopics and time windows. 


%Let $d_t \in \mathcal{D}$ be a document with a publication date $t$. Let $\mathcal{T}$ be the set of disjoint time windows such that $\mathcal{T} = \{t_1,t_2,t_3 ... t_n \}$. Each document in $\mathcal{D}$ can have only one publication date which implies it can only belong to a single time window $t \in t_i$. $d_t$ is also labelled with a set of aspects which are used to describe the content of the document. 

%Let $\mathcal{A}$ be a universal set of all aspects such that $A_d \subset \mathcal{A}$ is the set of aspects for the document $d_t$. 
In order to satisfy the aforementioned historical query intents which requires documents from relevant aspects and relevant points in time, we propose a search result diversification problem called \emph{Historical Search Result Diversification} task. In this task, given a set of retrieved results $R_q \subseteq \mathcal{D}$ for a query $q$, we intend to diversify aspects from $\mathcal{A}$ and time windows from $\mathcal{T}$ such that we get a set $S \subseteq R_q$ of $k$ documents that cover the most important aspects and time windows for a given topic expressed by $q$. As with prior work on \emph{explicit search result diversification}~\cite{agrawal_diversifying_2009}, we assume each topic $q$ has a set of subtopics $c \in C(q)$, with a probability distribution $P(c|q)$ which $S$ looks to satisfy. Generalizing the traditional search result diversification tasks to include time we seek to maximize an objective function $P(S|q)$ to find the best $S$ over a set of subtopics $C(q)$. 



%For a historical search task we want to diversify aspects from $\mathcal{A}$ and time windows from $\mathcal{T}$ such that we get a set $S$ of $k$ documents from $\mathcal{D}$ that cover the most important aspects and time windows for a given topic expressed by the query $q$. 



\begin{definition} The Historical Search Result Diversification task intends to find a set $S$ which maximizes $P(S|q)$ over a set of subtopics $C(q)$ as well as a set of time windows $T(q) = T(q) = \bigcup_{d_t \in R_q}{w(d_t)}$.

\begin{equation}
P(S|q) = \sum_{t \in T(q)} P(t|q) \sum_c P(c|q)(1-\prod_{d \in S}(1-V(d|q,c,t))
\end{equation}
\end{definition}


$P(S|q)$ represents the probability that the user finds at least one relevant document from an important time window. 
$V(d|q,c,t)$ is the utility of a document $d$ given subtopic $c$, query $q$ and in the time window $t$. This utility decreases for other documents if we add a document to $S$ which has a high probability of satisfying a user interested in time $t$ and subtopic $c$. By doing so we also expose ourselves to quirks of their interpretation of diversification, i.e, if there is a dominant time window or subtopic then more documents are added to $S$ until they are sufficiently satisfied. The problem we have defined is akin to a 2-dimensional diversification problem. Being a generalization to earlier formulations, which were based on the classical \textsc{Maximum k-Coverage Problem}, the historical search diversification task is also $\mathcal{NP}-$hard.  

%The intuition behind this objective function is similar to \cite{agrawal_diversifying_2009} with the exception of time which is considered as an extra dimension for diversification in this case. 


%Formally this can be seen as a 2 dimensional maximum coverage problem. 

%The problem we have defined is akin to a 2 dimensional diversification problem. To evaluate a diversification approach a test collection from the TREC diversity track is used. TREC also defines the measures needed to judge performance of retrieval models. TREC has released multiple test collections like clueweb09, etc (citations needed), typically spanning a year, with a query workload and judgements suited for a diversification task. Historical query intents however cannot be evaluated on these test collections because the topics and judgements made are for a diversification task and not a historical search intent. Our notion of relevance is special since we want documents which are historically significant; from important an important time period. Topics in the TREC test collections have subtopics whcih are either facets of a topic or disambiguations and the task is to saitisfy a user who could be interested in any of the intents possible. Subtopics for historical search can be considered to be similar to facets for a topic but the judgements made for the diversity track are not evaluated for importance in time. Hence we build a test collection suited for historical search tasks using a news archive which has the advantage of spanning multiple years and also reliable publication timestamps instead of crawl dates.

\section{Evaluation Measures} 
\label{sub:subsection_name}

%As with any user intent for search, using the right collection to evaluate the performance of retrieval models is imperative. According to Soboroff \cite{soboroff2013building}, to build a test collection the following points need to be addressed:

%\begin{enumerate}
%	\item Determine the task.
%  \item Identify a document collection.
%  \item Build topics.
%  \item Make relevance judgments.
%\end{enumerate}

\subsection{Extending Diversification Metrics} % (fold)
\label{sub:diversification_metrics}

% subsection diversification_metrics (end)

\paragraph{}
Like the TREC diversification task we also define our own measures to discriminate between historical search retrieval models. Since we follow a diversification based approach to historical search we adapt the existing diversity measures to take time into account. For the diversity track, traditional IR measures were adapted by adding a dimension of intents to evaluate the performance of retrieval models at diversifying said intents. For example, precision was modified to intent aware precision by computing a weighted summation of precision given a particular intent, over all intents. 

\begin{equation}
IA-Precsion_k=\frac{1}{|C|}\sum_{c=1}^{|C|}\frac{1}{k}\sum_{j=1}^{k}rel(j|c)
\end{equation}

where $C$ is the set of subtopics for a topic $q$ and $rel(j|c)$ is the relevance of a document at $j$ to a subtopic $c$. Similarly we extend the intent aware measures by adding time awareness to make them more suitable at measuring the performance of aspect and time diversification retrieval models. Time-aware Intent-aware Precision (TIA-Precision) is defined as follows:

\begin{equation}
TIA-Precsion_k= \sum_{t \in T(q)} P(t|q) \: \frac{1}{|C|}\sum_{c=1}^{|C|}\frac{1}{k}\sum_{j=1}^{k}rel(j|c,t)
\end{equation}

\paragraph{}
The other standard measures used by TREC for the diversity track are: IA-ERR, SBR (subtopic recall), IA-$\alpha$-NDCG and IA-MAP. We extend these measures similar to $TIA-Precsion_k$.

\begin{equation}
TIA-NDCG(q,k) = \sum_{t} P(t|q) \sum_{c} P(c|q) NDCG(q,k|c,t)
\end{equation}

\begin{equation}
TIA-ERR = \sum_{r}^{n} \frac{1}{r} \sum_{t} P(t|q) \sum_{c} P(c|q) rel(r|c,t) \prod_{i=1}^{r-1} (1-rel(i|c,t))
\end{equation}

\begin{equation}
TIA-AvgP(q)_k = \frac{\sum_{k=1}^{n} (TIA-Precision(k) * rel(k))}{\# relevant\:documents} 
\end{equation}

\begin{equation}
TIA-MAP = \frac{\sum_Q TIA-AvgP(q) }{|Q|}
\end{equation}

\begin{equation}
SBR_k = \frac{\# subtopics \: covered \: in \: k\:  +\:  \# time \: windows \: covered \: in \: k }{|subtopics+time\:windows|}
\end{equation}


\subsection{Time aware Subtopic recall (TIA-SBR)}

\paragraph{}
To accurately measure the historical value of a result set we need a measure that models the coverage of important time windows and subtopics. It is fair to consider the equal importance of each subtopic although doing the same for time would not provide an accurate way to discriminate. For example, it is safe to assume that a user searching for the history of the 9/11 bombings would prefer to get relevant documents from the year 2001 rather than 2007. Hence it desirable to reward result lists that rank relevant documents from important time periods. We introduce a variant of subtopic recall called time aware subtopic recall. This measure's discriminatory power comes from direct modeling of time windows as bursts rather than new subtopics like in our adaptation of subtopic recall. Each time window $t$ is given a burst weight $P(t|q)$ just like each subtopic.

\begin{equation}
burstrecall_k = \sum_t^{t \in S} P(t/q)
\end{equation}

\paragraph{}
A weighted interpretation of subtopic recall is given by the formula below. Considering equal importance for all subtopics leads to $P(c|q) = \frac{1}{|C|}$ which is the same as equation \ref{eq:tasbr}. 

\begin{equation}
SBR_k = \sum_c^{C \in S} P(c|q)
\end{equation}

\begin{equation}
\label{eq:tasbr}
TIA-SBR_k =  \alpha  SBR_k +  (1-\alpha) burstrecall_k
\end{equation}

\paragraph{}
Intent aware measures will favor algorithms that can cover more intents. Time aware measures will have favorable results for algorithms that select important time periods and intents. Hence by combining time awareness and intent awareness in the standard measures we are able to determine just how well an algorithm performs for a historical query intent. We also choose TIA-SBR as our primary discriminatory measure for a historical retrieval task. 
